require=function o(a,r,d){function c(i,e){if(!r[i]){if(!a[i]){var t="function"==typeof require&&require;if(!e&&t)return t(i,!0);if(h)return h(i,!0);var s=new Error("Cannot find module '"+i+"'");throw s.code="MODULE_NOT_FOUND",s}var n=r[i]={exports:{}};a[i][0].call(n.exports,function(e){return c(a[i][1][e]||e)},n,n.exports,o,a,r,d)}return r[i].exports}for(var h="function"==typeof require&&require,e=0;e<d.length;e++)c(d[e]);return c}({achievementController:[function(e,i,t){"use strict";cc._RF.push(i,"e094eAGealM05kL+kYX2izY","achievementController");cc.Class({extends:cc.Component,properties:{list:cc.Node,button:cc.Prefab,popups:[cc.Node],icons:[cc.SpriteFrame],dungeonXP:cc.Label},onEnable:function(){this.updateSpecialButton("truedeath"),this.updateSpecialButton("daredevil"),this.updateSpecialButton("already"),this.updateSpecialButton("overkill"),this.updateSpecialButton("darkness"),this.updateSpecialButton("lucky"),this.updateButton(this.levelMax),this.updateButton(this.xp),this.updateButton(this.tiles),this.updateButton(this.killstotal),this.updateButton(this.killsmelee),this.updateButton(this.killsranged),this.updateButton(this.killsmagic),this.updateButton(this.trapstotal),this.updateButton(this.trapsfire),this.updateButton(this.trapsice),this.updateButton(this.trapsacid),this.updateButton(this.trapselectricity),this.updateButton(this.trapsspikes),this.updateButton(this.trapspoison),this.updateButton(this.itemschests),this.updateButton(this.itemstotal),this.updateButton(this.itemsfire),this.updateButton(this.itemsice),this.updateButton(this.itemsacid),this.updateButton(this.itemselectricity),this.updateButton(this.itemsspikes),this.updateButton(this.itemspoison),this.updateButton(this.itemspotion),this.updateButton(this.damagetotal),this.updateButton(this.damagefire),this.updateButton(this.damageice),this.updateButton(this.damageacid),this.updateButton(this.damageelectricity),this.updateButton(this.damagespikes),this.updateButton(this.damagepoison),this.updateButton(this.damagemelee),this.updateButton(this.damageranged),this.updateButton(this.damagemagic),this.updateButton(this.deathtotal),this.updateButton(this.deathfire),this.updateButton(this.deathice),this.updateButton(this.deathacid),this.updateButton(this.deathelectricity),this.updateButton(this.deathspikes),this.updateButton(this.deathpoison),this.updateButton(this.deathmelee),this.updateButton(this.deathranged),this.updateButton(this.deathmagic)},start:function(){this.createSpecialButton("True Death","Get to -10HP","truedeath",1),this.createSpecialButton("Daredevil","Face a trap with 1HP and 0 shields","daredevil",1),this.createSpecialButton("Already back?","Die, then die again in the next floor","already",1),this.createSpecialButton("Overkill","Get an enemy to -10HP","overkill",1),this.createSpecialButton("Stop Moving!","Get 'Dungeon Moves' twice in a floor","darkness",1),this.createSpecialButton("Lucky","Cross a floor without hitting any trap","lucky",1),this.createButton("Explorer","Deepest floor you went",null,"levelMax",2,100),this.createButton("High level","Total XP spent",null,"xp",2,.001),this.createButton("Runner","Tiles walked",null,"tiles",2,.1),this.createButton("God of War","Enemies you defeated","kills","total",3,1),this.createButton("Warrior","Enemies you defeated with your sword","kills","melee",3,5),this.createButton("Archer","Enemies you defeated with your bow","kills","ranged",4,5),this.createButton("Archmage","Enemies you defeated with your wand","kills","magic",5,5),this.createButton("Trap Finder","Total traps found the hard way","traps","total",6,1),this.createButton("Getting warmer","Total fire traps found the hard way","traps","fire",6,10),this.createButton("Getting colder","Total ice traps found the hard way","traps","ice",6,10),this.createButton("Dirty floor","Total acid traps found the hard way","traps","acid",6,10),this.createButton("Tesla attack","Total electricity traps found the hard way","traps","electricity",6,10),this.createButton("Holed floor","Total spikes traps found the hard way","traps","spikes",6,10),this.createButton("Holed wall","Total poisoned dart traps found the hard way","traps","poison",6,10),this.createButton("Treasure Hunter","Total chests found","items","chests",7,1),this.createButton("Spender","Total items used","items","total",8,.5),this.createButton("Like sunscreen","Total fire shields used","items","fire",9,5),this.createButton("A warm blanket","Total ice shields used","items","ice",9,5),this.createButton("Still intact","Total acid shields used","items","acid",9,5),this.createButton("Fully isolated","Total electricity shields used","items","electricity",9,5),this.createButton("Steel boots","Total spikes shields used","items","spikes",9,5),this.createButton("Antidote","Total poison shields used","items","poison",9,5),this.createButton("Not addicted","Total potions used","items","potion",10,5),this.createButton("It hurts everywhere","Total damage taken","damage","total",11,5),this.createButton("Needs some Aloe","Total fire damage","damage","fire",11,10),this.createButton("I want a blanket","Total ice damage","damage","ice",11,10),this.createButton("I need a base","Total acid damage","damage","acid",11,10),this.createButton("I need rubber boots","Total electricity damage","damage","electricity",11,10),this.createButton("Not again...","Total spikes damage","damage","spikes",11,10),this.createButton("Feeling kind green","Total poison damage","damage","poison",11,10),this.createButton("I need a shield","Total damage in melee combat","damage","melee",3,10),this.createButton("This bow is bad","Total damage in ranged combat","damage","ranged",4,10),this.createButton("I need a staff","Total damage in magic combat","damage","magic",5,10),this.createButton("Kenny","Total deaths","death","total",12,100),this.createButton("Barbecue","Total burned deaths","death","fire",12,100),this.createButton("Popsicle","Total frozen deaths","death","ice",12,100),this.createButton("Not much left","Total dissolved deaths","death","acid",12,100),this.createButton("Full of Energy","Total electricity deaths","death","electricity",12,100),this.createButton("Is Vlad here?","Total impaled deaths","death","spikes",12,100),this.createButton("Is there an antidote?","Total poisoned deaths","death","poison",12,100),this.createButton("Shaky hand","Total deaths in melee combat","death","melee",12,100),this.createButton("Bad Sight","Total deaths in ranged combat","death","ranged",12,100),this.createButton("Curled Tongue","Total deaths in magic combat","death","magic",12,100)},createSpecialButton:function(e,i,t,s){var n="unique",o=0;window.gameSession.stats.unique[t]&&(o=1);var a=n+t,r=o/1,d=o+" / 1",c=cc.instantiate(this.button);c.parent=this.list,c.progress=r,c.prize=1e4,c.sub=n,c.field=t,c.mult=1,c.id=s,c.getChildByName("Name").getComponent(cc.Label).string=e,c.getChildByName("Description").getComponent(cc.Label).string=i,c.getChildByName("Value").getComponent(cc.Label).string=1e4+"XP",c.getChildByName("Progress").getComponent(cc.ProgressBar).progress=r,c.getChildByName("Completion").getComponent(cc.Label).string=d,window.gameSession.achievements.unique[t]?c.getChildByName("Icon").getComponent(cc.Sprite).spriteFrame=this.icons[s]:c.getChildByName("Icon").getComponent(cc.Sprite).spriteFrame=this.icons[0];var h=new cc.Component.EventHandler;h.target=this.node,h.component="achievementController",h.handler="getSpecialPrize",c.getComponent(cc.Button).clickEvents.push(h),this[a]=c},getSpecialPrize:function(e){var i=e.target,t=i.progress,s=(i.sub,i.field);1<=t&&!window.gameSession.achievements.unique[s]&&(window.gameSession.xp+=i.prize,this.dungeonXP.string="XP: "+window.gameSession.xp,window.gameSession.achievements.unique[s]=!0),this.updateSpecialButton(s),this.saveGame()},updateSpecialButton:function(e){var i=this["unique"+e];if(i){var t=0;window.gameSession.stats.unique[e]&&(t=1);var s=t/1,n=t+" / 1";i.progress=s,i.prize=1e4,i.getChildByName("Value").getComponent(cc.Label).string=1e4+"XP",i.getChildByName("Progress").getComponent(cc.ProgressBar).progress=s,i.getChildByName("Completion").getComponent(cc.Label).string=n,window.gameSession.achievements.unique[e]?i.getChildByName("Icon").getComponent(cc.Sprite).spriteFrame=this.icons[i.id]:i.getChildByName("Icon").getComponent(cc.Sprite).spriteFrame=this.icons[0]}},createButton:function(e,i,t,s,n,o){var a=void 0,r=void 0,d=void 0;t?(a=window.gameSession.achievements[t][s],r=window.gameSession.stats[t][s],d=t+s):(a=window.gameSession.achievements[s],r=window.gameSession.stats[s],d=s);var c=100*(a+1),h=c,m=r/c,w=r+" / "+c;1<o?h*=o:o<1&&(m=r/(c/o),w=r+" / "+c/o);var g=cc.instantiate(this.button);g.parent=this.list,g.progress=m,g.prize=h,g.sub=t,g.field=s,g.mult=o,g.id=n,g.getChildByName("Name").getComponent(cc.Label).string=e,g.getChildByName("Description").getComponent(cc.Label).string=i,g.getChildByName("Value").getComponent(cc.Label).string=h+"XP",g.getChildByName("Progress").getComponent(cc.ProgressBar).progress=m,g.getChildByName("Completion").getComponent(cc.Label).string=w,g.getChildByName("Icon").getComponent(cc.Sprite).spriteFrame=a<1?this.icons[0]:this.icons[n];var l=new cc.Component.EventHandler;l.target=this.node,l.component="achievementController",l.handler="getPrize",g.getComponent(cc.Button).clickEvents.push(l),this[d]=g},getPrize:function(e){var i=e.target,t=i.progress,s=i.sub,n=i.field;1<=t&&(s?(window.gameSession.achievements[s][n]++,100<window.gameSession.achievements[s][n]&&(window.gameSession.achievements[s][n]=100,window.gameSession.xp-=i.prize)):(window.gameSession.achievements[n]++,100<window.gameSession.achievements[n]&&(window.gameSession.achievements[n]=100,window.gameSession.xp-=i.prize)),window.gameSession.xp+=i.prize,this.dungeonXP.string="XP: "+window.gameSession.xp),this.updateButton(i,s,n),this.saveGame()},updateButton:function(e){if(e){var i=e.mult,t=e.sub,s=e.field,n=void 0,o=void 0;t?(n=window.gameSession.achievements[t][s],o=window.gameSession.stats[t][s]):(n=window.gameSession.achievements[s],o=window.gameSession.stats[s]);var a=100*(n+1),r=a,d=o/a,c=o+" / "+a;1<i?r*=i:i<1&&(d=o/(a/i),c=o+" / "+a/i),e.progress=d,e.prize=r,e.getChildByName("Value").getComponent(cc.Label).string=r+"XP",e.getChildByName("Progress").getComponent(cc.ProgressBar).progress=d,e.getChildByName("Completion").getComponent(cc.Label).string=c,e.getChildByName("Icon").getComponent(cc.Sprite).spriteFrame=n<1?this.icons[0]:this.icons[e.id]}},saveGame:function(){cc.sys.localStorage.setItem("gameSession",JSON.stringify(window.gameSession))},close:function(){this.node.active=!1,window.gameGlobals.popup=!1},open:function(){if(!(window.gameSession.hp<1)){for(var e=0;e<this.popups.length;e++)this.popups[e].active=!1;this.node.active=!0,window.gameGlobals.popup=!0}}});cc._RF.pop()},{}],deathController:[function(e,i,t){"use strict";cc._RF.push(i,"6c4a65Zyl5N9a5j6+E0StCV","deathController"),cc.Class({extends:cc.Component,properties:{deathPopup:cc.Node},iDied:function(){this.close(),window.gameSession.level=window.gameSession.levelMin,window.gameSession.hp=window.gameSession.hpMax,window.gameSession.death=!0,window.gameSession.job=0,window.gameSession.inventory.fire=Math.min(window.gameSession.inventory.fireMin,window.gameSession.inventory.fireMax),window.gameSession.inventory.ice=Math.min(window.gameSession.inventory.iceMin,window.gameSession.inventory.iceMax),window.gameSession.inventory.acid=Math.min(window.gameSession.inventory.acidMin,window.gameSession.inventory.acidMax),window.gameSession.inventory.electricity=Math.min(window.gameSession.inventory.electricityMin,window.gameSession.inventory.electricityMax),window.gameSession.inventory.spikes=Math.min(window.gameSession.inventory.spikesMin,window.gameSession.inventory.spikesMax),window.gameSession.inventory.poison=Math.min(window.gameSession.inventory.poisonMin,window.gameSession.inventory.poisonMax),window.gameSession.inventory.potion=Math.min(window.gameSession.inventory.potionMin,window.gameSession.inventory.potionMax),cc.director.loadScene("gameScene")},start:function(){},close:function(){this.node.active=!1,window.gameGlobals.popup=!1},open:function(){this.node.active=!0,window.gameGlobals.popup=!0}}),cc._RF.pop()},{}],gridController:[function(e,i,t){"use strict";cc._RF.push(i,"2bcdfsBj75NDKCCf3TUBANw","gridController");cc.Class({extends:cc.Component,properties:{tilePrefab:cc.Prefab,feedbackPrefab:cc.Prefab,logPrefab:cc.Prefab,gridNode:cc.Node,nextButton:cc.Node,upgradePopup:cc.Node,deathPopup:cc.Node,jobPopup:cc.Node,canvas:cc.Node,inventoryButton:cc.Node,dungeonAchievement:cc.Node,feedbackLog:cc.Node,dungeonHP:cc.Label,dungeonLevel:cc.Label,dungeonXP:cc.Label,trapFinder:cc.Label,treasureHunter:cc.Label,tracker:cc.Label,deathMessage:cc.Label,door_corner:cc.SpriteFrame,door_side:cc.SpriteFrame,deadend:cc.SpriteFrame,line:cc.SpriteFrame,curve:cc.SpriteFrame,threeway:cc.SpriteFrame,fourway:cc.SpriteFrame,unknown:cc.SpriteFrame,open:cc.SpriteFrame,danger:[cc.SpriteFrame],monster:[cc.SpriteFrame],chest:cc.SpriteFrame,stair_down:cc.SpriteFrame,stair_up:cc.SpriteFrame,lever:cc.SpriteFrame,stone:cc.SpriteFrame},start:function(){this.enumSides={undefined:0,block:1,wall:2,open:3},this.enumTile={undefined:0,entrance:1,exit:2,deadend:3,corridor:4},this.enumStatus={hidden:0,flashing:1,visible:2},this.enumContent={empty:0,treasure:1,danger:2,darkness:3,monster:4,lever:5},this.enumSprite={entrance:0,exit:1,deadend:2,curve:3,line:4,threeway:5,fourway:6},this.enumClass={undefined:0,rogue:1,fighter:2,wizard:3},this.initUI(),0!=window.gameSession.job?this.showUpgrades():this.showJobSelection(),this.saveGame(),this.clicks=0,this.dangers=0,this.treasures=0,this.monsters=0,this.clickable=0,this.dungeonMoves=0,this.running=!1,this.hitTrap=!1,this.timeToRun=.5;var e=Math.min(Math.floor(window.gameSession.level/10),10);this.size=10+e;this.tileWidth=[75,68,62.1,57.2,53,49.3,46.1,43.2,40.7,38.5,36.5][e],this.subtileWidth=[54,48.9,44.7,41.2,38.1,35.5,33.2,31.1,29.3,27.7,26.2][e],this.gridSize=this.size*this.size-1,this.initGrid(this.size),this.closed=window.gameSession.level%25==0,this.setDoorDirection(this.size),this.closed&&this.setLever(this.size),this.buildStack=new Array,this.buildMaze(this.entrance.x,this.entrance.y),this.fillGrid(this.size),this.showClickZones(this.entrance.x,this.entrance.y),this.revealSubSprite(this.entrance.x,this.entrance.y),window.gameSession.treasureHunter&&(this.treasureHunter.node.active=!0),window.gameSession.trapFinder&&(this.trapFinder.node.active=!0),window.gameSession.tracker&&(this.tracker.node.active=!0)},saveGame:function(){cc.sys.localStorage.setItem("gameSession",JSON.stringify(window.gameSession))},showUpgrades:function(){var e=Math.min(window.gameSession.upgrades.fireMin,window.gameSession.upgrades.fireMax,window.gameSession.upgrades.iceMin,window.gameSession.upgrades.iceMax,window.gameSession.upgrades.acidMin,window.gameSession.upgrades.acidMax,window.gameSession.upgrades.electricityMin,window.gameSession.upgrades.electricityMax,window.gameSession.upgrades.spikesMin,window.gameSession.upgrades.spikesMax,window.gameSession.upgrades.poisonMin,window.gameSession.upgrades.poisonMax,window.gameSession.upgrades.potionMin,window.gameSession.upgrades.potionMax,window.gameSession.upgrades.hpMax);window.gameSession.xp>e&&(this.upgradePopup.active=!0,window.gameGlobals.popup=!0)},showJobSelection:function(){this.jobPopup.active=!0},initUI:function(){this.dungeonLevel.string="Floor: "+window.gameSession.level,this.dungeonXP.string="XP: "+window.gameSession.xp,this.dungeonHP.string="HP: "+window.gameSession.hp},cleanGrid:function(e){this.nextButton.active=!1,this.clicks=0,this.dangers=0,this.treasures=0;for(var i=this.monsters=0;i<e;i++)for(var t=0;t<e;t++)this.gridUI[i][t].destroy()},initGrid:function(e){this.grid=new Array(e),this.gridUI=new Array(e);for(var i=0;i<e;i++){this.grid[i]=new Array(e),this.gridUI[i]=new Array(e);for(var t=0;t<e;t++)this.grid[i][t]={},this.grid[i][t].x=i,this.grid[i][t].y=t,this.grid[i][t].north=this.enumSides[void 0],this.grid[i][t].south=this.enumSides[void 0],this.grid[i][t].east=this.enumSides[void 0],this.grid[i][t].west=this.enumSides[void 0],this.grid[i][t].tile=this.enumTile[void 0],this.grid[i][t].status=this.enumStatus.hidden,this.grid[i][t].content=this.enumContent.empty,0==i&&(this.grid[i][t].north=this.enumSides.block),i==e-1&&(this.grid[i][t].south=this.enumSides.block),0==t&&(this.grid[i][t].west=this.enumSides.block),t==e-1&&(this.grid[i][t].east=this.enumSides.block)}},showClickZones:function(e,i){var t=this.grid[e][i],s=0;t.north==this.enumSides.open&&this.addClickFunction(e-1,i)&&s++,t.south==this.enumSides.open&&this.addClickFunction(e+1,i)&&s++,t.east==this.enumSides.open&&this.addClickFunction(e,i+1)&&s++,t.west==this.enumSides.open&&this.addClickFunction(e,i-1)&&s++,1<s&&(this.running=!1)},addClickFunction:function(e,i){var t=this.grid[e][i];if(t.status==this.enumStatus.visible)return!1;if(t.status==this.enumStatus.flashing)return this.lastClickZone=this.gridUI[e][i],!0;t.status=this.enumStatus.flashing,this.clickable++;var s=this.gridUI[e][i];s.getComponent(cc.Sprite).spriteFrame=this.open;var n=new cc.Component.EventHandler;return n.target=this.node,n.component="gridController",n.handler="gridClick",s.tile=t,s.getComponent(cc.Button).clickEvents.push(n),this.lastClickZone=s,!0},startRunning:function(){this.running=!0,this.timeToRun=.5},run:function(e){var i={};this.lastClickZone?(i.target=this.lastClickZone,(this.lastClickZone=null)!=i.target&&this.gridClick(i)):this.running=!1},gridClick:function(e){if(!(window.gameSession.hp<1||window.gameGlobals.popup))if(e.target.tile.tile!=this.enumTile.exit||!e.target.used||this.closed){if(!e.target.used){e.target.used=!0,this.clickable--,window.gameSession.stats.tiles++,window.gameSession.stats.tiles%1e3==0&&this.showFeedback("Achievement: Runner",new cc.Color(0,255,0),this.dungeonAchievement,!0),window.gameSession.treasureHunter&&(this.treasureHunter.node.active=!0),window.gameSession.trapFinder&&(this.trapFinder.node.active=!0),window.gameSession.tracker&&(this.tracker.node.active=!0),this.startRunning();var i=e.target.tile;i.status=this.enumStatus.visible,e.target.getComponent(cc.Sprite).spriteFrame=i.sprite,this.showClickZones(i.x,i.y),window.gameSession.hp<window.gameSession.hpMax&&0<window.gameSession.inventory.potion&&(window.gameSession.inventory.potion--,window.gameSession.stats.items.potion++,window.gameSession.stats.items.potion%100==0&&this.showFeedback("Achievement: Not addicted",new cc.Color(0,255,0),this.dungeonAchievement,!0),window.gameSession.stats.items.total++,window.gameSession.stats.items.total%100==0&&this.showFeedback("Achievement: Spender",new cc.Color(0,255,0),this.dungeonAchievement,!0),this.showFeedback("Used potion",new cc.Color(0,255,0),e.target,!0),window.gameSession.job==this.enumClass.wizard?(window.gameSession.hp+=2,this.showFeedback("+2HP",new cc.Color(0,255,0),this.dungeonHP.node,!1)):(window.gameSession.hp++,this.showFeedback("+1HP",new cc.Color(0,255,0),this.dungeonHP.node,!1)),this.dungeonHP.string="HP: "+window.gameSession.hp);var t=0;if(this.clicks++,this.clicks==this.gridSize&&(t+=window.gameSession.level*(this.gridSize+1),window.gameSession.job==this.enumClass.wizard&&(t+=window.gameSession.level*this.gridSize)),t+=window.gameSession.level,window.gameSession.job==this.enumClass.wizard&&(t+=window.gameSession.level),i.content==this.enumContent.treasure&&(this.running=!1,this.giveTreasure(Math.floor(100*Math.random()+1),e.target)),i.content==this.enumContent.danger){this.running=!1;var s=Math.floor(6*Math.random()+1);this.fightDanger(s,e.target),this.findSubSprite(i,s),0<window.gameSession.hp?(t+=25*window.gameSession.level,window.gameSession.job==this.enumClass.rogue&&(t+=25*window.gameSession.level),window.gameSession.stats.traps.total++,window.gameSession.stats.traps.total%100==0&&this.showFeedback("Achievement: Trap Finder",new cc.Color(0,255,0),this.dungeonAchievement,!0)):(this.deathPopup.active=!0,window.gameGlobals.popup=!0,this.deathMessage.string="You died! \n You were "+this.lastDanger+"!")}if(i.content==this.enumContent.darkness){this.showFeedback("Dungeon Moves!",new cc.Color(255,0,0),this.dungeonLevel.node,!0),this.dungeonMoves++,1<this.dungeonMoves&&(window.gameSession.stats.unique.darkness=!0,window.gameSession.achievements.unique.darkness||this.showFeedback("Achievement: Stop Moving!",new cc.Color(0,255,0),this.dungeonAchievement,!0)),this.running=!1;var n=e.target.tile.x,o=e.target.tile.y;this.cleanGrid(this.size),this.initGrid(this.size),this.closed=window.gameSession.level%25==0,this.setDoorDirection(this.size),this.closed&&this.setLever(this.size),this.buildStack=new Array,this.buildMaze(this.entrance.x,this.entrance.y),this.grid[this.entrance.x][this.entrance.y].status=this.enumStatus.hidden,this.grid[n][o].status=this.enumStatus.visible,this.fillGrid(this.size),this.showClickZones(n,o)}if(i.content==this.enumContent.monster){this.running=!1;var a=Math.floor(3*Math.random()+1);this.fightMonster(a,e.target,0),this.findSubSprite(i,a),0<window.gameSession.hp?(t+=25*window.gameSession.level,window.gameSession.job==this.enumClass.fighter&&(t+=25*window.gameSession.level)):(this.deathPopup.active=!0,window.gameGlobals.popup=!0,this.deathMessage.string="You died! \n You were "+this.lastDanger+"!")}if(i.content==this.enumContent.lever){this.showFeedback("Stairs Unlocked",new cc.Color(0,255,0),this.dungeonLevel.node,!0),this.closed=!1;var r=this.grid[this.exit.x][this.exit.y];this.findSubSprite(r,-1),r.status==this.enumStatus.visible&&(this.revealSubSprite(this.exit.x,this.exit.y),this.nextButton.active=!0)}if(this.revealSubSprite(i.x,i.y),i.tile==this.enumTile.exit){this.running=!1,this.closed?this.showFeedback("Stairs Locked",new cc.Color(255,0,0),this.dungeonLevel.node,!0):this.nextButton.active=!0;var d=0;if(window.gameSession.level%10==0?d=2:window.gameSession.level%5==0&&(d=1),0<d){this.monsters++;var c=Math.floor(3*Math.random()+1);this.fightMonster(c,e.target,d),this.findSubSprite(i,c),0<window.gameSession.hp?(t+=25*window.gameSession.level,window.gameSession.job==this.enumClass.fighter&&(t+=25*window.gameSession.level)):(this.deathPopup.active=!0,window.gameGlobals.popup=!0,this.deathMessage.string="You died! \n You were "+this.lastDanger+"!")}}window.gameSession.xp+=t,this.dungeonXP.string="XP: "+window.gameSession.xp,this.showFeedback("+"+t+"XP",new cc.Color(0,255,0),this.dungeonXP.node,!1)}}else this.nextLevel()},revealSubSprite:function(e,i){var t=this.grid[e][i],s=this.gridUI[e][i],n=s.getChildByName("content");n.rotation=360-s.rotation,t.subsprite&&(n.getComponent(cc.Sprite).spriteFrame=t.subsprite)},fightMonster:function(e,i,t){this.monsters--,this.tracker.string="Enemies: "+this.monsters;var s=Math.floor(window.gameSession.level/5)+1+t;window.gameSession.job==this.enumClass.fighter&&s--;var n=void 0,o=void 0,a=void 0,r=void 0,d=void 0,c=void 0;switch(e){case 1:n="Fought Orc",o="murdered",a="melee",r="I need a shield",d="Warrior",c="Shaky Hand";break;case 2:n="Fought Cockatrice",o="petrified",a="ranged",r="This bow is bad",d="Archer",c="Bad Sight";break;case 3:n="Fought Ghost",o="drained of life",a="magic",r="I need a staff",d="Archmage",c="Curled Tongue"}1<t?n+=" Boss":0<t&&(n+=" Sub-boss"),this.showFeedback(n,new cc.Color(255,0,0),i,!0),this.lastDanger=o,s-window.gameSession.inventory[a]<-9&&(window.gameSession.stats.unique.overkill=!0,window.gameSession.achievements.unique.overkill||this.showFeedback("Achievement: Overkill",new cc.Color(0,255,0),this.dungeonAchievement,!0)),0<(s-=Math.min(s,window.gameSession.inventory[a]))&&(this.showFeedback("-"+s+"HP",new cc.Color(255,0,0),this.dungeonHP.node,!1),window.gameSession.hp-=s,window.gameSession.stats.damage[a]+=s,window.gameSession.stats.damage[a]%100==0&&this.showFeedback("Achievement: "+r,new cc.Color(0,255,0),this.dungeonAchievement,!0),window.gameSession.stats.damage.total+=s,window.gameSession.stats.damage.total%100==0&&this.showFeedback("Achievement: It hurts everywhere",new cc.Color(0,255,0),this.dungeonAchievement,!0),this.dungeonHP.string="HP: "+window.gameSession.hp),0<window.gameSession.hp?(window.gameSession.stats.kills[a]++,window.gameSession.stats.kills[a]%100==0&&this.showFeedback("Achievement: "+d,new cc.Color(0,255,0),this.dungeonAchievement,!0),window.gameSession.stats.kills.total++,window.gameSession.stats.kills.total%100==0&&this.showFeedback("Achievement: God of War",new cc.Color(0,255,0),this.dungeonAchievement,!0)):(window.gameSession.hp<-9&&(window.gameSession.stats.unique.truedeath=!0,window.gameSession.achievements.unique.truedeath||this.showFeedback("Achievement: True Death",new cc.Color(0,255,0),this.dungeonAchievement,!0)),window.gameSession.death&&(window.gameSession.stats.unique.already=!0,window.gameSession.achievements.unique.already||this.showFeedback("Achievement: Already Back?",new cc.Color(0,255,0),this.dungeonAchievement,!0)),window.gameSession.stats.death[a]++,window.gameSession.stats.death[a]%100==0&&this.showFeedback("Achievement: "+c,new cc.Color(0,255,0),this.dungeonAchievement,!0),window.gameSession.stats.death.total++,window.gameSession.stats.death.total%100==0&&this.showFeedback("Achievement: Kenny",new cc.Color(0,255,0),this.dungeonAchievement,!0))},fightDanger:function(e,i){this.dangers--,this.hitTrap=!0,this.trapFinder.string="Traps: "+this.dangers;var t=Math.floor(window.gameSession.level/10+1);window.gameSession.job==this.enumClass.rogue&&t--;var s=void 0,n=void 0,o=void 0,a=void 0,r=void 0,d=void 0,c=void 0;switch(window.gameSession.hp<2&&window.gameSession.inventory.fire+window.gameSession.inventory.ice+window.gameSession.inventory.acid+window.gameSession.inventory.electricity+window.gameSession.inventory.spikes+window.gameSession.inventory.poison<1&&(window.gameSession.stats.unique.daredevil=!0,window.gameSession.achievements.unique.daredevil||this.showFeedback("Achievement: Daredevil",new cc.Color(0,255,0),this.dungeonAchievement,!0)),e){case 1:s="Fire Trap",n="burned",o="fire",a="Fire",r="Getting warmer",d="Like sunscreen",c="Barbecue";break;case 2:s="Freezing Trap",n="frozen",o="ice",a="Ice",r="Getting colder",d="A warm blanket",c="Popsicle";break;case 3:s="Acid Trap",n="dissolved",o="acid",a="Acid",r="Dirty floor",d="Still intact",c="Not much left";break;case 4:s="Electricity Trap",n="electrocuted",o="electricity",a="Electricity",r="Tesla attack",d="Fully isolated",c="Full of Energy";break;case 5:s="Floor Spikes Trap",n="impaled",o="spikes",a="Spikes",r="Holed floor",d="Steel boots",c="Is Vlad here?";break;case 6:s="Poisoned Dart Trap",n="poisoned",o="poison",a="Poison",r="Holed wall",d="Antidote",c="Is there an antidote?"}if(t-=window.gameSession.skills[o+"Shield"],this.showFeedback(s,new cc.Color(255,0,0),i,!0),this.lastDanger=n,window.gameSession.stats.traps[o]++,window.gameSession.stats.traps[o]%100==0&&this.showFeedback("Achievement: "+r,new cc.Color(0,255,0),this.dungeonAchievement,!0),0<window.gameSession.inventory[o]){var h=window.gameSession.inventory[o],m=Math.min(t,h);window.gameSession.inventory[o]-=m,window.gameSession.stats.items[o]+=m,window.gameSession.stats.items[o]%100==0&&this.showFeedback("Achievement: "+d,new cc.Color(0,255,0),this.dungeonAchievement,!0),window.gameSession.stats.items.total+=m,window.gameSession.stats.items.total%100==0&&this.showFeedback("Achievement: Spender",new cc.Color(0,255,0),this.dungeonAchievement,!0),t-=m,this.showFeedback("-"+m+" "+a+" Shield",new cc.Color(255,0,0),this.dungeonLevel.node,!0)}0<t&&(this.showFeedback("-"+t+"HP",new cc.Color(255,0,0),this.dungeonHP.node,!1),window.gameSession.hp-=t,window.gameSession.stats.damage[o]+=t,window.gameSession.stats.items[o]%100==0&&this.showFeedback("Achievement: "+d,new cc.Color(0,255,0),this.dungeonAchievement,!0),window.gameSession.stats.damage.total+=t,window.gameSession.stats.damage.total%100==0&&this.showFeedback("Achievement: It hurts everywhere",new cc.Color(0,255,0),this.dungeonAchievement,!0),this.dungeonHP.string="HP: "+window.gameSession.hp),window.gameSession.hp<=0&&(window.gameSession.hp<-9&&(window.gameSession.stats.unique.truedeath=!0,window.gameSession.achievements.unique.truedeath||this.showFeedback("Achievement: True Death",new cc.Color(0,255,0),this.dungeonAchievement,!0)),window.gameSession.death&&(window.gameSession.stats.unique.already=!0,window.gameSession.achievements.unique.already||this.showFeedback("Achievement: Already Back?",new cc.Color(0,255,0),this.dungeonAchievement,!0)),window.gameSession.stats.death[o]++,window.gameSession.stats.death[o]%100==0&&this.showFeedback("Achievement: "+c,new cc.Color(0,255,0),this.dungeonAchievement,!0),window.gameSession.stats.death.total++,window.gameSession.stats.death.total%100==0&&this.showFeedback("Achievement: Kenny",new cc.Color(0,255,0),this.dungeonAchievement,!0))},giveTreasure:function(e,i){this.treasures--,this.treasureHunter.string="Treasures: "+this.treasures;var t=1+window.gameSession.skills.totalShield;window.gameSession.stats.items.chests+=t,window.gameSession.stats.items.chests%100==0&&this.showFeedback("Achievement: Treasure Hunter",new cc.Color(0,255,0),this.dungeonAchievement,!0),e<=10?(window.gameSession.inventory.potion=Math.min(window.gameSession.inventory.potion+t,window.gameSession.inventory.potionMax),this.showFeedback("Got "+t+" Potion",new cc.Color(0,255,0),i,!0)):e<=25?(window.gameSession.inventory.fire=Math.min(window.gameSession.inventory.fire+t,window.gameSession.inventory.fireMax),this.showFeedback("Got "+t+" Fire Shield",new cc.Color(0,255,0),i,!0)):e<=40?(window.gameSession.inventory.ice=Math.min(window.gameSession.inventory.ice+t,window.gameSession.inventory.iceMax),this.showFeedback("Got "+t+" Ice Shield",new cc.Color(0,255,0),i,!0)):e<=55?(window.gameSession.inventory.acid=Math.min(window.gameSession.inventory.acid+t,window.gameSession.inventory.acidMax),this.showFeedback("Got "+t+" Acid Shield",new cc.Color(0,255,0),i,!0)):e<=70?(window.gameSession.inventory.electricity=Math.min(window.gameSession.inventory.electricity+t,window.gameSession.inventory.electricityMax),this.showFeedback("Got "+t+" Electricity Shield",new cc.Color(0,255,0),i,!0)):e<=85?(window.gameSession.inventory.spikes=Math.min(window.gameSession.inventory.spikes+t,window.gameSession.inventory.spikesMax),this.showFeedback("Got "+t+" Spikes Shield",new cc.Color(0,255,0),i,!0)):e<=100&&(window.gameSession.inventory.poison=Math.min(window.gameSession.inventory.poison+t,window.gameSession.inventory.poisonMax),this.showFeedback("Got "+t+" Poison Shield",new cc.Color(0,255,0),i,!0))},nextLevel:function(){window.gameSession.hp<1||(window.gameSession.death=!1,this.hitTrap||(window.gameSession.stats.unique.lucky=!0,window.gameSession.achievements.unique.lucky||this.showFeedback("Achievement: Lucky",new cc.Color(0,255,0),this.dungeonAchievement,!0)),window.gameSession.level++,window.gameSession.level>window.gameSession.stats.levelMax&&(window.gameSession.stats.levelMax=window.gameSession.level),window.gameSession.stats.levelMax%100==0&&this.showFeedback("Achievement: Explorer",new cc.Color(0,255,0),this.dungeonAchievement,!0),cc.director.loadScene("gameScene"))},fillGrid:function(e){for(var i=0;i<e;i++)for(var t=0;t<e;t++){var s=this.grid[i][t];this.makeWall(s),this.findSprite(s),this.findSubSprite(s,-1);var n=cc.instantiate(this.tilePrefab);(this.gridUI[i][t]=n).width=this.tileWidth,n.height=this.tileWidth;var o=n.getChildByName("content");o.width=this.subtileWidth,o.height=this.subtileWidth,n.parent=this.gridNode,n.rotation=s.rotation;var a=n.getComponent(cc.Sprite);s.status==this.enumStatus.visible?a.spriteFrame=s.sprite:s.status==this.enumStatus.hidden&&(a.spriteFrame=this.unknown)}},findSubSprite:function(e,i){e.tile==this.enumTile.entrance?e.subsprite=this.stair_up:e.tile==this.enumTile.exit&&this.closed?e.subsprite=this.stone:e.tile==this.enumTile.exit?e.subsprite=this.stair_down:e.content==this.enumContent.treasure?e.subsprite=this.chest:e.content==this.enumContent.danger&&-1<i?e.subsprite=this.danger[i-1]:e.content==this.enumContent.monster&&-1<i?e.subsprite=this.monster[i-1]:e.content==this.enumContent.lever&&(e.subsprite=this.lever)},findSprite:function(e){if(e.tile==this.enumTile.deadend)this.showDeadend(e);else{var i=0;e.north==this.enumSides.open&&i++,e.south==this.enumSides.open&&i++,e.east==this.enumSides.open&&i++,e.west==this.enumSides.open&&i++,1==i?this.showDeadend(e):2==i&&(e.north==this.enumSides.open&&e.south==this.enumSides.open||e.east==this.enumSides.open&&e.west==this.enumSides.open)?this.showLine(e):2==i?this.showCurve(e):3==i?this.showThreeWay(e):4==i?this.showFourWay(e):console.error("ERROR: no sprite",e)}},showDoor:function(e){var i=0;e.north==this.enumSides.block&&i++,e.south==this.enumSides.block&&i++,e.east==this.enumSides.block&&i++,e.west==this.enumSides.block&&i++,2==i?(e.sprite=this.door_corner,1==e.north?1==e.west?e.rotation=0:1==e.east&&(e.rotation=90):1==e.south&&(1==e.west?e.rotation=270:1==e.east&&(e.rotation=180))):1==i?(e.sprite=this.door_side,1==e.north?e.rotation=0:1==e.east?e.rotation=90:1==e.south?e.rotation=180:1==e.west&&(e.rotation=270)):console.error("ERROR: should not have that amount of blocks",e,i)},showDeadend:function(e){e.sprite=this.deadend,e.north==this.enumSides.open?e.rotation=270:e.east==this.enumSides.open?e.rotation=0:e.south==this.enumSides.open?e.rotation=90:e.west==this.enumSides.open&&(e.rotation=180),Math.floor(100*Math.random()+1)<=25+Math.min(25,window.gameSession.level)&&e.content==this.enumContent.empty&&e.tile!=this.enumTile.entrance&&e.tile!=this.enumTile.exit?(e.content=this.enumContent.danger,this.dangers++,this.trapFinder.string="Traps: "+this.dangers):e.content==this.enumContent.empty&&e.tile!=this.enumTile.entrance&&e.tile!=this.enumTile.exit&&(e.content=this.enumContent.treasure,this.treasures++,this.treasureHunter.string="Treasures: "+this.treasures)},showLine:function(e){e.sprite=this.line,e.north==this.enumSides.open?e.rotation=0:e.east==this.enumSides.open&&(e.rotation=90)},showCurve:function(e){e.sprite=this.curve,e.north==this.enumSides.open?e.west==this.enumSides.open?e.rotation=180:e.east==this.enumSides.open&&(e.rotation=270):e.south==this.enumSides.open&&(e.west==this.enumSides.open?e.rotation=90:e.east==this.enumSides.open&&(e.rotation=0))},showThreeWay:function(e){e.sprite=this.threeway,e.north==this.enumSides.wall||e.north==this.enumSides.block?e.rotation=0:e.east==this.enumSides.wall||e.east==this.enumSides.block?e.rotation=90:e.south==this.enumSides.wall||e.south==this.enumSides.block?e.rotation=180:e.west==this.enumSides.wall||e.west==this.enumSides.block?e.rotation=270:console.error("ERROR: no wall",e)},showFourWay:function(e){e.sprite=this.fourway,e.rotation=0},makeWall:function(e){e.north==this.enumSides[void 0]&&(e.north=this.enumSides.wall),e.south==this.enumSides[void 0]&&(e.south=this.enumSides.wall),e.east==this.enumSides[void 0]&&(e.east=this.enumSides.wall),e.west==this.enumSides[void 0]&&(e.west=this.enumSides.wall)},buildMaze:function(e,i){this.buildStack.push({x:e,y:i});var t=this.grid[e][i],s=this.findPath(t);if(0==s){if(t.tile==this.enumTile[void 0]&&(t.tile=this.enumTile.deadend),this.buildStack.pop(),0<this.buildStack.length){var n=this.buildStack.pop();this.buildMaze(n.x,n.y)}}else{if(t.tile==this.enumTile[void 0]){t.tile=this.enumTile.corridor;var o=Math.floor(100*Math.random()+1);if(o<=5&&t.content==this.enumContent.empty){var a=Math.floor(100*Math.random()+1),r=Math.min(25,window.gameSession.level);0==window.gameSession.level%5&&a<=1?t.content=this.enumContent.darkness:a<=25+r?(t.content=this.enumContent.danger,this.dangers++,this.trapFinder.string="Traps: "+this.dangers):(t.content=this.enumContent.treasure,this.treasures++,this.treasureHunter.string="Treasures: "+this.treasures)}else o<=10&&t.content==this.enumContent.empty&&(t.content=this.enumContent.monster,this.monsters++,this.tracker.string="Enemies: "+this.monsters)}var d=Math.floor(Math.random()*s+1);this.makePath(e,i,d)}},makePath:function(e,i,t){var s=this.grid[e][i],n=0;return s.north==this.enumSides[void 0]&&n++,n==t?(s.north=this.enumSides.open,this.grid[e-1][i].south=this.enumSides.open,void this.buildMaze(e-1,i)):(s.east==this.enumSides[void 0]&&n++,n==t?(s.east=this.enumSides.open,this.grid[e][i+1].west=this.enumSides.open,void this.buildMaze(e,i+1)):(s.south==this.enumSides[void 0]&&n++,n==t?(s.south=this.enumSides.open,this.grid[e+1][i].north=this.enumSides.open,void this.buildMaze(e+1,i)):(s.west==this.enumSides[void 0]&&n++,n==t?(s.west=this.enumSides.open,this.grid[e][i-1].east=this.enumSides.open,void this.buildMaze(e,i-1)):void 0)))},findPath:function(e){var i=0;return e.north==this.enumSides[void 0]&&this.isPathFree("north",e,e.x-1,e.y)?i++:e.north==this.enumSides[void 0]&&(e.north=this.enumSides.wall),e.south==this.enumSides[void 0]&&this.isPathFree("south",e,e.x+1,e.y)?i++:e.south==this.enumSides[void 0]&&(e.south=this.enumSides.wall),e.east==this.enumSides[void 0]&&this.isPathFree("east",e,e.x,e.y+1)?i++:e.east==this.enumSides[void 0]&&(e.east=this.enumSides.wall),e.west==this.enumSides[void 0]&&this.isPathFree("west",e,e.x,e.y-1)?i++:e.west==this.enumSides[void 0]&&(e.west=this.enumSides.wall),i},isPathFree:function(e,i,t,s){if(i[e]==this.enumSides.block)return!1;var n=this.grid[t][s];return n.tile!=this.enumTile.deadend&&n.tile!=this.enumTile.corridor&&(n.tile==this.enumTile[void 0]||n.tile==this.enumTile.exit)},setDoorDirection:function(e){switch(Math.floor(4*Math.random()+1)){case 1:this.makeDoors(0,Math.floor(Math.random()*e),e-1,Math.floor(Math.random()*e));break;case 2:this.makeDoors(e-1,Math.floor(Math.random()*e),0,Math.floor(Math.random()*e));break;case 3:this.makeDoors(Math.floor(Math.random()*e),0,Math.floor(Math.random()*e),e-1);break;case 4:this.makeDoors(Math.floor(Math.random()*e),e-1,Math.floor(Math.random()*e),0)}},setLever:function(e){var i=Math.floor(Math.random()*(e-2)+1),t=Math.floor(Math.random()*(e-2)+1),s=this.grid[i][t];s.content=this.enumContent.lever,cc.log(s)},makeDoors:function(e,i,t,s){var n=this.grid[e][i];n.tile=this.enumTile.entrance,n.status=this.enumStatus.visible,this.entrance={x:e,y:i},(n=this.grid[t][s]).tile=this.enumTile.exit,this.exit={x:t,y:s}},showFeedback:function(e,i,t,s){var n=cc.instantiate(this.feedbackPrefab);n.parent=this.canvas,n.color=i;var o=t.parent.convertToWorldSpaceAR(t.position);o=this.canvas.convertToNodeSpaceAR(o),n.x=o.x,n.y=o.y,n.getComponent(cc.Label).string=e;var a=void 0;a=s?cc.sequence(cc.moveBy(2,cc.v2(0,100)),cc.fadeOut(2),cc.callFunc(this.removeFeedback,this,n)):cc.sequence(cc.spawn(cc.moveBy(2,cc.v2(0,100)),cc.fadeOut(2)),cc.callFunc(this.removeFeedback,this,n)),n.runAction(a);var r=cc.instantiate(this.logPrefab);r.parent=this.feedbackLog,r.getComponent(cc.Label).string=e,r.color=i},removeFeedback:function(e){e.destroy()},update:function(e){this.running&&(this.timeToRun-=e,this.timeToRun<0&&(this.startRunning(),this.run(this.size)))}});cc._RF.pop()},{}],inventoryController:[function(e,i,t){"use strict";cc._RF.push(i,"417d1Ks4C1G6rI6w1DtonjZ","inventoryController"),cc.Class({extends:cc.Component,properties:{inventoryFire:cc.Label,inventoryIce:cc.Label,inventoryAcid:cc.Label,inventoryElectricity:cc.Label,inventorySpikes:cc.Label,inventoryPoison:cc.Label,inventoryPotion:cc.Label,popups:[cc.Node]},onEnable:function(){this.updateLabel("fire"," Shield"),this.updateLabel("ice"," Shield"),this.updateLabel("acid"," Shield"),this.updateLabel("electricity"," Shield"),this.updateLabel("spikes"," Shield"),this.updateLabel("poison"," Shield"),this.updateLabel("potion","")},start:function(){},updateLabel:function(e,i){var t=this.jsUcfirst(e);this["inventory"+t].string=t+i+": "+window.gameSession.inventory[e]+"/"+window.gameSession.inventory[e+"Max"]},jsUcfirst:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},close:function(){this.node.active=!1,window.gameGlobals.popup=!1},open:function(){if(!(window.gameSession.hp<1)){for(var e=0;e<this.popups.length;e++)this.popups[e].active=!1;this.node.active=!0,window.gameGlobals.popup=!0}}}),cc._RF.pop()},{}],jobController:[function(e,i,t){"use strict";cc._RF.push(i,"27833am8SxCGaYvkSU/1GHv","jobController"),cc.Class({extends:cc.Component,properties:{jobPrefab:cc.Prefab,popups:[cc.Node],icons:[cc.SpriteFrame]},start:function(){this.enumClass={undefined:0,rogue:1,fighter:2,wizard:3}},setClass:function(e,i){window.gameSession.job=this.enumClass[i],this.saveGame(),this.close()},saveGame:function(){cc.sys.localStorage.setItem("gameSession",JSON.stringify(window.gameSession))},close:function(){this.node.active=!1,window.gameGlobals.popup=!1},open:function(){if(!(window.gameSession.hp<1)){for(var e=0;e<this.popups.length;e++)this.popups[e].active=!1;this.node.active=!0,window.gameGlobals.popup=!0}}}),cc._RF.pop()},{}],loadingController:[function(e,i,t){"use strict";cc._RF.push(i,"eb052hXqyVDe45o+9GyjV2u","loadingController"),cc.Class({extends:cc.Component,properties:{sprite:cc.Sprite,tutorial:[cc.SpriteFrame],animated:cc.Node},start:function(){this.animate();this.index=0;this.initSession({major:0,minor:4,fix:2}),this.next()},verifyUpdate:function(e){0==e.major&&1==e.minor&&this.updateV2(),0==e.major&&2==e.minor&&this.updateV3(),0==e.major&&3==e.minor&&this.updateV4()},initSession:function(e){if(this.loadGame(),window.gameGlobals={},null!=window.gameSession)return window.gameSession.saveVersion||(window.gameSession.saveVersion={major:0,minor:1,fix:0}),void this.verifyUpdate(window.gameSession.saveVersion);window.gameSession={},window.gameSession.xp=0,window.gameSession.hp=3,window.gameSession.hpMax=3,window.gameSession.level=1,window.gameSession.levelMin=1,window.gameSession.treasureHunter=!1,window.gameSession.trapFinder=!1,window.gameSession.tracker=!1,window.gameSession.inventory={},window.gameSession.inventory.fire=0,window.gameSession.inventory.fireMin=0,window.gameSession.inventory.fireMax=3,window.gameSession.inventory.ice=0,window.gameSession.inventory.iceMin=0,window.gameSession.inventory.iceMax=3,window.gameSession.inventory.acid=0,window.gameSession.inventory.acidMin=0,window.gameSession.inventory.acidMax=3,window.gameSession.inventory.electricity=0,window.gameSession.inventory.electricityMin=0,window.gameSession.inventory.electricityMax=3,window.gameSession.inventory.spikes=0,window.gameSession.inventory.spikesMin=0,window.gameSession.inventory.spikesMax=3,window.gameSession.inventory.poison=0,window.gameSession.inventory.poisonMin=0,window.gameSession.inventory.poisonMax=3,window.gameSession.inventory.potion=0,window.gameSession.inventory.potionMin=0,window.gameSession.inventory.potionMax=3,window.gameSession.inventory.melee=1,window.gameSession.inventory.ranged=1,window.gameSession.inventory.magic=1,window.gameSession.upgrades={},window.gameSession.upgrades.fireMin=1e3,window.gameSession.upgrades.fireMax=1e3,window.gameSession.upgrades.iceMin=1e3,window.gameSession.upgrades.iceMax=1e3,window.gameSession.upgrades.acidMin=1e3,window.gameSession.upgrades.acidMax=1e3,window.gameSession.upgrades.electricityMin=1e3,window.gameSession.upgrades.electricityMax=1e3,window.gameSession.upgrades.spikesMin=1e3,window.gameSession.upgrades.spikesMax=1e3,window.gameSession.upgrades.poisonMin=1e3,window.gameSession.upgrades.poisonMax=1e3,window.gameSession.upgrades.potionMin=1e3,window.gameSession.upgrades.potionMax=1e3,window.gameSession.upgrades.hpMax=1e3,window.gameSession.upgrades.levelMin=1e3,window.gameSession.upgrades.info=1e3,window.gameSession.upgrades.melee=1e3,window.gameSession.upgrades.ranged=1e3,window.gameSession.upgrades.magic=1e3,window.gameSession.stats={},window.gameSession.stats.unique={},window.gameSession.stats.death={},window.gameSession.stats.death.total=0,window.gameSession.stats.death.fire=0,window.gameSession.stats.death.ice=0,window.gameSession.stats.death.acid=0,window.gameSession.stats.death.electricity=0,window.gameSession.stats.death.spikes=0,window.gameSession.stats.death.poison=0,window.gameSession.stats.death.melee=0,window.gameSession.stats.death.ranged=0,window.gameSession.stats.death.magic=0,window.gameSession.stats.damage={},window.gameSession.stats.damage.total=0,window.gameSession.stats.damage.fire=0,window.gameSession.stats.damage.ice=0,window.gameSession.stats.damage.acid=0,window.gameSession.stats.damage.electricity=0,window.gameSession.stats.damage.spikes=0,window.gameSession.stats.damage.poison=0,window.gameSession.stats.damage.melee=0,window.gameSession.stats.damage.ranged=0,window.gameSession.stats.damage.magic=0,window.gameSession.stats.items={},window.gameSession.stats.items.chests=0,window.gameSession.stats.items.total=0,window.gameSession.stats.items.fire=0,window.gameSession.stats.items.ice=0,window.gameSession.stats.items.acid=0,window.gameSession.stats.items.electricity=0,window.gameSession.stats.items.spikes=0,window.gameSession.stats.items.poison=0,window.gameSession.stats.items.potion=0,window.gameSession.stats.kills={},window.gameSession.stats.kills.total=0,window.gameSession.stats.kills.melee=0,window.gameSession.stats.kills.ranged=0,window.gameSession.stats.kills.magic=0,window.gameSession.stats.traps={},window.gameSession.stats.traps.total=0,window.gameSession.stats.traps.fire=0,window.gameSession.stats.traps.ice=0,window.gameSession.stats.traps.acid=0,window.gameSession.stats.traps.electricity=0,window.gameSession.stats.traps.spikes=0,window.gameSession.stats.traps.poison=0,window.gameSession.stats.levelMax=0,window.gameSession.stats.xp=0,window.gameSession.stats.tiles=0,window.gameSession.achievements={},window.gameSession.achievements.unique={},window.gameSession.achievements.death={},window.gameSession.achievements.death.total=0,window.gameSession.achievements.death.fire=0,window.gameSession.achievements.death.ice=0,window.gameSession.achievements.death.acid=0,window.gameSession.achievements.death.electricity=0,window.gameSession.achievements.death.spikes=0,window.gameSession.achievements.death.poison=0,window.gameSession.achievements.death.melee=0,window.gameSession.achievements.death.ranged=0,window.gameSession.achievements.death.magic=0,window.gameSession.achievements.damage={},window.gameSession.achievements.damage.total=0,window.gameSession.achievements.damage.fire=0,window.gameSession.achievements.damage.ice=0,window.gameSession.achievements.damage.acid=0,window.gameSession.achievements.damage.electricity=0,window.gameSession.achievements.damage.spikes=0,window.gameSession.achievements.damage.poison=0,window.gameSession.achievements.damage.melee=0,window.gameSession.achievements.damage.ranged=0,window.gameSession.achievements.damage.magic=0,window.gameSession.achievements.items={},window.gameSession.achievements.items.chests=0,window.gameSession.achievements.items.total=0,window.gameSession.achievements.items.fire=0,window.gameSession.achievements.items.ice=0,window.gameSession.achievements.items.acid=0,window.gameSession.achievements.items.electricity=0,window.gameSession.achievements.items.spikes=0,window.gameSession.achievements.items.poison=0,window.gameSession.achievements.items.potion=0,window.gameSession.achievements.kills={},window.gameSession.achievements.kills.total=0,window.gameSession.achievements.kills.melee=0,window.gameSession.achievements.kills.ranged=0,window.gameSession.achievements.kills.magic=0,window.gameSession.achievements.traps={},window.gameSession.achievements.traps.total=0,window.gameSession.achievements.traps.fire=0,window.gameSession.achievements.traps.ice=0,window.gameSession.achievements.traps.acid=0,window.gameSession.achievements.traps.electricity=0,window.gameSession.achievements.traps.spikes=0,window.gameSession.achievements.traps.poison=0,window.gameSession.achievements.levelMax=0,window.gameSession.achievements.xp=0,window.gameSession.achievements.tiles=0,window.gameSession.saveVersion=e},loadGame:function(){window.gameSession=JSON.parse(cc.sys.localStorage.getItem("gameSession"))},next:function(){cc.director.loadScene("gameScene")},updateV2:function(){window.gameSession.treasures=0,window.gameSession.traps=0,window.gameSession.treasureHunter=!1,window.gameSession.trapFinder=!1,window.gameSession.saveVersion={major:0,minor:2,fix:0}},updateV3:function(){window.gameSession.tracker=!1,window.gameSession.inventory.melee=1,window.gameSession.inventory.ranged=1,window.gameSession.inventory.magic=1,window.gameSession.upgrades.melee=1e3,window.gameSession.upgrades.ranged=1e3,window.gameSession.upgrades.magic=1e3,window.gameSession.stats={},window.gameSession.stats.death={},window.gameSession.stats.death.total=0,window.gameSession.stats.death.fire=0,window.gameSession.stats.death.ice=0,window.gameSession.stats.death.acid=0,window.gameSession.stats.death.electricity=0,window.gameSession.stats.death.spikes=0,window.gameSession.stats.death.poison=0,window.gameSession.stats.death.melee=0,window.gameSession.stats.death.ranged=0,window.gameSession.stats.death.magic=0,window.gameSession.stats.damage={},window.gameSession.stats.damage.total=0,window.gameSession.stats.damage.fire=0,window.gameSession.stats.damage.ice=0,window.gameSession.stats.damage.acid=0,window.gameSession.stats.damage.electricity=0,window.gameSession.stats.damage.spikes=0,window.gameSession.stats.damage.poison=0,window.gameSession.stats.damage.melee=0,window.gameSession.stats.damage.ranged=0,window.gameSession.stats.damage.magic=0,window.gameSession.stats.items={},window.gameSession.stats.items.chests=window.gameSession.treasures,window.gameSession.stats.items.total=0,window.gameSession.stats.items.fire=0,window.gameSession.stats.items.ice=0,window.gameSession.stats.items.acid=0,window.gameSession.stats.items.electricity=0,window.gameSession.stats.items.spikes=0,window.gameSession.stats.items.poison=0,window.gameSession.stats.items.potion=0,window.gameSession.stats.kills={},window.gameSession.stats.kills.total=0,window.gameSession.stats.kills.melee=0,window.gameSession.stats.kills.ranged=0,window.gameSession.stats.kills.magic=0,window.gameSession.stats.traps={},window.gameSession.stats.traps.total=window.gameSession.traps,window.gameSession.stats.traps.fire=0,window.gameSession.stats.traps.ice=0,window.gameSession.stats.traps.acid=0,window.gameSession.stats.traps.electricity=0,window.gameSession.stats.traps.spikes=0,window.gameSession.stats.traps.poison=0,window.gameSession.stats.unique={},window.gameSession.stats.levelMax=window.gameSession.levelMax,window.gameSession.stats.xp=0,window.gameSession.stats.tiles=0,window.gameSession.achievements={},window.gameSession.achievements.death={},window.gameSession.achievements.death.total=0,window.gameSession.achievements.death.fire=0,window.gameSession.achievements.death.ice=0,window.gameSession.achievements.death.acid=0,window.gameSession.achievements.death.electricity=0,window.gameSession.achievements.death.spikes=0,window.gameSession.achievements.death.poison=0,window.gameSession.achievements.death.melee=0,window.gameSession.achievements.death.ranged=0,window.gameSession.achievements.death.magic=0,window.gameSession.achievements.damage={},window.gameSession.achievements.damage.total=0,window.gameSession.achievements.damage.fire=0,window.gameSession.achievements.damage.ice=0,window.gameSession.achievements.damage.acid=0,window.gameSession.achievements.damage.electricity=0,window.gameSession.achievements.damage.spikes=0,window.gameSession.achievements.damage.poison=0,window.gameSession.achievements.damage.melee=0,window.gameSession.achievements.damage.ranged=0,window.gameSession.achievements.damage.magic=0,window.gameSession.achievements.items={},window.gameSession.achievements.items.chests=0,window.gameSession.achievements.items.total=0,window.gameSession.achievements.items.fire=0,window.gameSession.achievements.items.ice=0,window.gameSession.achievements.items.acid=0,window.gameSession.achievements.items.electricity=0,window.gameSession.achievements.items.spikes=0,window.gameSession.achievements.items.poison=0,window.gameSession.achievements.items.potion=0,window.gameSession.achievements.kills={},window.gameSession.achievements.kills.total=0,window.gameSession.achievements.kills.melee=0,window.gameSession.achievements.kills.ranged=0,window.gameSession.achievements.kills.magic=0,window.gameSession.achievements.traps={},window.gameSession.achievements.traps.total=0,window.gameSession.achievements.traps.fire=0,window.gameSession.achievements.traps.ice=0,window.gameSession.achievements.traps.acid=0,window.gameSession.achievements.traps.electricity=0,window.gameSession.achievements.traps.spikes=0,window.gameSession.achievements.traps.poison=0,window.gameSession.achievements.unique={},window.gameSession.achievements.levelMax=0,window.gameSession.achievements.xp=0,window.gameSession.achievements.tiles=0,window.gameSession.saveVersion={major:0,minor:4,fix:2}},updateV4:function(){window.gameSession.tutorial={},window.gameSession.skills={},window.gameSession.skills.treasureHunter=window.gameSession.treasureHunter,window.gameSession.skills.fireShield=0,window.gameSession.skills.iceShield=0,window.gameSession.skills.acidShield=0,window.gameSession.skills.electricityShield=0,window.gameSession.skills.spikesShield=0,window.gameSession.skills.poisonShield=0,window.gameSession.skills.totalShield=0,window.gameSession.skills.trapFinder=window.gameSession.trapFinder,window.gameSession.skills.fireFinder=!1,window.gameSession.skills.iceFinder=!1,window.gameSession.skills.acidFinder=!1,window.gameSession.skills.electricityFinder=!1,window.gameSession.skills.spikesFinder=!1,window.gameSession.skills.poisonFinder=!1,window.gameSession.skills.tracker=window.gameSession.tracker,window.gameSession.skills.meleeTracker=!1,window.gameSession.skills.rangedTracker=!1,window.gameSession.skills.magicTracker=!1,window.gameSession.job=0,window.gameSession.saveVersion={major:0,minor:4,fix:0}},animate:function(){var e=cc.sequence(cc.moveBy(.1,cc.v2(-100,0)),cc.moveBy(.2,cc.v2(0,200)),cc.moveBy(.2,cc.v2(-200,0)),cc.moveBy(.4,cc.v2(0,-400)),cc.moveBy(.2,cc.v2(200,0)),cc.moveBy(.2,cc.v2(0,200)),cc.moveBy(.2,cc.v2(200,0)),cc.moveBy(.2,cc.v2(0,200)),cc.moveBy(.2,cc.v2(200,0)),cc.moveBy(.4,cc.v2(0,-400)),cc.moveBy(.2,cc.v2(-200,0)),cc.moveBy(.2,cc.v2(0,200)),cc.moveBy(.1,cc.v2(-100,0)));this.animated.runAction(cc.repeatForever(e))}}),cc._RF.pop()},{}],logController:[function(e,i,t){"use strict";cc._RF.push(i,"e14cbLjOG5L8JgGJDveC/6v","logController"),cc.Class({extends:cc.Component,properties:{popups:[cc.Node]},onEnable:function(){},start:function(){},saveGame:function(){cc.sys.localStorage.setItem("gameSession",JSON.stringify(window.gameSession))},close:function(){this.node.active=!1,window.gameGlobals.popup=!1},open:function(){if(!(window.gameSession.hp<1)){for(var e=0;e<this.popups.length;e++)this.popups[e].active=!1;this.node.active=!0,window.gameGlobals.popup=!0}}}),cc._RF.pop()},{}],tutorialController:[function(e,i,t){"use strict";cc._RF.push(i,"ea3e5sNQUVBsJin+etBB5Q2","tutorialController"),cc.Class({extends:cc.Component,properties:{popups:[cc.Node]},onEnable:function(){},start:function(){},saveGame:function(){cc.sys.localStorage.setItem("gameSession",JSON.stringify(window.gameSession))},close:function(){this.node.active=!1,window.gameGlobals.popup=!1},open:function(){if(!(window.gameSession.hp<1)){for(var e=0;e<this.popups.length;e++)this.popups[e].active=!1;this.node.active=!0,window.gameGlobals.popup=!0}}}),cc._RF.pop()},{}],upgradeController:[function(e,i,t){"use strict";cc._RF.push(i,"c4e2cji+KROBamtHwGOccSx","upgradeController");cc.Class({extends:cc.Component,properties:{grid:cc.Node,canvas:cc.Node,dungeonAchievement:cc.Node,feedbackLog:cc.Node,button:cc.Prefab,feedbackPrefab:cc.Prefab,logPrefab:cc.Prefab,dungeonXP:cc.Label,inventoryFire:cc.Label,inventoryIce:cc.Label,inventoryAcid:cc.Label,inventoryElectricity:cc.Label,inventorySpikes:cc.Label,inventoryPoison:cc.Label,inventoryPotion:cc.Label,popups:[cc.Node],icons:[cc.SpriteFrame]},start:function(){this.setButtons()},onEnable:function(){this.checkSecretPassage(),this.checkSpecialButton(window.gameSession.stats.traps.total,window.gameSession.trapFinder,this.trapFinder),this.checkSpecialButton(window.gameSession.stats.items.chests,window.gameSession.treasureHunter,this.treasureHunter),this.checkSpecialButton(window.gameSession.stats.kills.total,window.gameSession.tracker,this.tracker),this.checkPermanentShield("fire"),this.checkPermanentShield("ice"),this.checkPermanentShield("acid"),this.checkPermanentShield("electricity"),this.checkPermanentShield("spikes"),this.checkPermanentShield("poison"),this.checkPermanentShield("total")},setButtons:function(){window.gameSession&&(this.createButton("Fire Protection","fireMin","fire","Starting amount of Fire Shields",0,1),this.createButton("Ice Protection","iceMin","ice","Starting amount of Ice Shields",0,1),this.createButton("Acid Protection","acidMin","acid","Starting amount of Acid Shields",0,1),this.createButton("Electricity Protection","electricityMin","electricity","Starting amount of Electricity Shields",0,1),this.createButton("Spikes Protection","spikesMin","spikes","Starting amount of Spikes Shields",0,1),this.createButton("Poison Protection","poisonMin","poison","Starting amount of Poison Shields",0,1),this.createButton("Fire Pocket","fireMax",null,"Maximum amount of Fire Shields",1,1),this.createButton("Ice Pocket","iceMax",null,"Maximum amount of Ice Shields",1,1),this.createButton("Acid Pocket","acidMax",null,"Maximum amount of Acid Shields",1,1),this.createButton("Electricity Pocket","electricityMax",null,"Maximum amount of Electricity Shields",1,1),this.createButton("Spikes Pocket","spikesMax",null,"Maximum amount of Spikes Shields",1,1),this.createButton("Poison Pocket","poisonMax",null,"Maximum amount of Poison Shields",1,1),this.createButton("Starting Potion","potionMin","potion","Starting amount of Potions",3,1),this.createButton("Potion Pocket","potionMax",null,"Maximum amount of Potions",1,1),this.createButton("Health Points","hpMax",null,"Increases maximum HP",2,1),this.createButton("Sword Skill","melee",null,"Increases skill with swords",5,2),this.createButton("Bow Skill","ranged",null,"Increases skill with bows",6,2),this.createButton("Wand Skill","magic",null,"Increases skill with wands",7,2),this.createSecretPassageButton(),this.checkSecretPassage(),this.createSpecialButton("trapFinder","Trap Finder","Find how many traps exist in a floor.","upgradeTrapFinder"),this.checkSpecialButton(window.gameSession.stats.traps.total,window.gameSession.trapFinder,this.trapFinder),this.createSpecialButton("treasureHunter","Treasure Hunter","Find how many chests exist in a floor.","upgradeTreasureHunter"),this.checkSpecialButton(window.gameSession.stats.items.chests,window.gameSession.treasureHunter,this.treasureHunter),this.createSpecialButton("tracker","Tracker","Find how many enemies are in a floor.","upgradeTracker"),this.checkSpecialButton(window.gameSession.stats.kills.total,window.gameSession.tracker,this.tracker),this.createPermanentShield("Fireproof","Permanent fire shield","fire",8),this.checkPermanentShield("fire"),this.createPermanentShield("Freezeproof","Permanent ice shield","ice",8),this.checkPermanentShield("ice"),this.createPermanentShield("Non-corrosive","Permanent acid shield","acid",8),this.checkPermanentShield("acid"),this.createPermanentShield("Ground Wire","Permanent electricity shield","electricity",8),this.checkPermanentShield("electricity"),this.createPermanentShield("Impenetrable","Permanent spikes shield","spikes",8),this.checkPermanentShield("spikes"),this.createPermanentShield("Mithridatism","Permanent poison shield","poison",8),this.checkPermanentShield("poison"),this.createPermanentShield("Scavenger","Increase itens got by chest","total",9),this.checkPermanentShield("total"))},createPermanentShield:function(e,i,t,s){var n=cc.instantiate(this.button);n.parent=this.grid,n.getChildByName("Name").getComponent(cc.Label).string=e,n.getChildByName("Description").getComponent(cc.Label).string=i,n.getChildByName("Value").getComponent(cc.Label).string=window.gameSession.skills[t+"Shield"],n.getChildByName("Price").getComponent(cc.Label).string=5e3*(window.gameSession.skills[t+"Shield"]+1)+"XP",n.getChildByName("Icon").getComponent(cc.Sprite).spriteFrame=this.icons[s],n.field=t;var o=new cc.Component.EventHandler;o.target=this.node,o.component="upgradeController",o.handler="permanentShield",n.getComponent(cc.Button).clickEvents.push(o),this["perm"+t]=n},checkPermanentShield:function(e){window.gameSession.skills[e+"Shield"]<window.gameSession.achievements.items[e]&&this["perm"+e]?this["perm"+e].active=!0:this["perm"+e]&&(this["perm"+e].active=!1)},permanentShield:function(e){var i=e.target,t=i.field,s=5e3*(window.gameSession.skills[t+"Shield"]+1);window.gameSession.xp>=s&&(window.gameSession.xp-=s,window.gameSession.stats.xp+=s,window.gameSession.stats.xp%1e4==0&&this.showFeedback("Achievement: High Level",new cc.Color(0,255,0),this.dungeonAchievement,!0),this.dungeonXP.string="XP: "+window.gameSession.xp,window.gameSession.skills[t+"Shield"]++,i.getChildByName("Value").getComponent(cc.Label).string=window.gameSession.skills[t+"Shield"],i.getChildByName("Price").getComponent(cc.Label).string=s+5e3+"XP",this.saveGame()),this.checkPermanentShield(t)},createSpecialButton:function(e,i,t,s){var n=cc.instantiate(this.button);n.parent=this.grid,(this[e]=n).getChildByName("Name").getComponent(cc.Label).string=i,n.getChildByName("Description").getComponent(cc.Label).string=t,n.getChildByName("Value").getComponent(cc.Label).string=0,n.getChildByName("Price").getComponent(cc.Label).string="5000XP",n.getChildByName("Icon").getComponent(cc.Sprite).spriteFrame=this.icons[4];var o=new cc.Component.EventHandler;o.target=this.node,o.component="upgradeController",o.handler=s,n.getComponent(cc.Button).clickEvents.push(o)},checkSpecialButton:function(e,i,t){49<e&&!i&&t?t.active=!0:t&&(t.active=!1)},upgradeSpecial:function(e,i){var t=e.target;5e3<=window.gameSession.xp&&(window.gameSession.xp-=5e3,window.gameSession.stats.xp+=5e3,window.gameSession.stats.xp%1e4==0&&this.showFeedback("Achievement: High Level",new cc.Color(0,255,0),this.dungeonAchievement,!0),this.dungeonXP.string="XP: "+window.gameSession.xp,window.gameSession[i]=!0,t.getChildByName("Value").getComponent(cc.Label).string=1,t.getChildByName("Price").getComponent(cc.Label).string="5000XP",this.saveGame())},upgradeTrapFinder:function(e){this.upgradeSpecial(e,"trapFinder"),this.checkSpecialButton(window.gameSession.stats.traps.total,window.gameSession.trapFinder,this.trapFinder)},upgradeTreasureHunter:function(e){this.upgradeSpecial(e,"treasureHunter"),this.checkSpecialButton(window.gameSession.stats.items.chests,window.gameSession.treasureHunter,this.treasureHunter)},upgradeTracker:function(e){this.upgradeSpecial(e,"tracker"),this.checkSpecialButton(window.gameSession.stats.kills.total,window.gameSession.tracker,this.tracker)},createSecretPassageButton:function(){var e=cc.instantiate(this.button);e.parent=this.grid,(this.secretPassage=e).getChildByName("Name").getComponent(cc.Label).string="Secret Passage",e.getChildByName("Description").getComponent(cc.Label).string="The floor you start back when you die.",e.getChildByName("Value").getComponent(cc.Label).string=window.gameSession.levelMin,window.gameSession.upgrades.levelMin||(window.gameSession.upgrades.levelMin=1e3),e.getChildByName("Price").getComponent(cc.Label).string=window.gameSession.upgrades.levelMin+"XP",e.getChildByName("Icon").getComponent(cc.Sprite).spriteFrame=this.icons[4];var i=new cc.Component.EventHandler;i.target=this.node,i.component="upgradeController",i.handler="upgradeSecretPassage",e.getComponent(cc.Button).clickEvents.push(i)},checkSecretPassage:function(){window.gameSession.levelMin+5<window.gameSession.stats.levelMax&&this.secretPassage?this.secretPassage.active=!0:this.secretPassage&&(this.secretPassage.active=!1)},upgradeSecretPassage:function(e){var i=e.target;window.gameSession.xp>=window.gameSession.upgrades.levelMin&&(window.gameSession.xp-=window.gameSession.upgrades.levelMin,window.gameSession.stats.xp+=window.gameSession.upgrades.levelMin,window.gameSession.stats.xp%1e4==0&&this.showFeedback("Achievement: High Level",new cc.Color(0,255,0),this.dungeonAchievement,!0),this.dungeonXP.string="XP: "+window.gameSession.xp,1==window.gameSession.levelMin?window.gameSession.levelMin=5:window.gameSession.levelMin+=5,i.getChildByName("Value").getComponent(cc.Label).string=window.gameSession.levelMin,window.gameSession.upgrades.levelMin+=1e3,i.getChildByName("Price").getComponent(cc.Label).string=window.gameSession.upgrades.levelMin+"XP",this.saveGame()),this.checkSecretPassage()},createButton:function(e,i,t,s,n,o){var a=cc.instantiate(this.button);a.parent=this.grid,a.getChildByName("Name").getComponent(cc.Label).string=e,a.getChildByName("Description").getComponent(cc.Label).string=s,null!=window.gameSession.inventory[i]?a.getChildByName("Value").getComponent(cc.Label).string=window.gameSession.inventory[i]:a.getChildByName("Value").getComponent(cc.Label).string=window.gameSession[i],a.getChildByName("Price").getComponent(cc.Label).string=window.gameSession.upgrades[i]*o+"XP",a.getChildByName("Icon").getComponent(cc.Sprite).spriteFrame=this.icons[n],a.field=i,a.item=t,a.mult=o;var r=new cc.Component.EventHandler;r.target=this.node,r.component="upgradeController",r.handler="upgrade",a.getComponent(cc.Button).clickEvents.push(r)},upgrade:function(e){var i=e.target,t=i.field;window.gameSession.xp>=window.gameSession.upgrades[t]&&(window.gameSession.xp-=window.gameSession.upgrades[t],window.gameSession.stats.xp+=window.gameSession.upgrades[t],window.gameSession.stats.xp%1e4==0&&this.showFeedback("Achievement: High Level",new cc.Color(0,255,0),this.dungeonAchievement,!0),this.dungeonXP.string="XP: "+window.gameSession.xp,null!=window.gameSession.inventory[t]?(window.gameSession.inventory[t]+=1,i.getChildByName("Value").getComponent(cc.Label).string=window.gameSession.inventory[t],i.item&&this.giveItem(i.item)):(window.gameSession[t]+=1,i.getChildByName("Value").getComponent(cc.Label).string=window.gameSession[t]),window.gameSession.upgrades[t]+=1e3,i.getChildByName("Price").getComponent(cc.Label).string=window.gameSession.upgrades[t]*i.mult+"XP",this.saveGame())},giveItem:function(e){window.gameSession.inventory[e]+1<=window.gameSession.inventory[e+"Max"]&&window.gameSession.inventory[e]++},saveGame:function(){cc.sys.localStorage.setItem("gameSession",JSON.stringify(window.gameSession))},close:function(){this.node.active=!1,window.gameGlobals.popup=!1},open:function(){if(!(window.gameSession.hp<1)){for(var e=0;e<this.popups.length;e++)this.popups[e].active=!1;this.node.active=!0,window.gameGlobals.popup=!0}},showFeedback:function(e,i,t,s){var n=cc.instantiate(this.feedbackPrefab);n.parent=this.canvas,n.color=i;var o=t.parent.convertToWorldSpaceAR(t.position);o=this.canvas.convertToNodeSpaceAR(o),n.x=o.x,n.y=o.y,n.getComponent(cc.Label).string=e;var a=void 0;a=s?cc.sequence(cc.moveBy(2,cc.v2(0,100)),cc.fadeOut(2),cc.callFunc(this.removeFeedback,this,n)):cc.sequence(cc.spawn(cc.moveBy(2,cc.v2(0,100)),cc.fadeOut(2)),cc.callFunc(this.removeFeedback,this,n)),n.runAction(a);var r=cc.instantiate(this.logPrefab);r.parent=this.feedbackLog,r.getComponent(cc.Label).string=e,r.color=i},removeFeedback:function(e){e.destroy()}});cc._RF.pop()},{}]},{},["gridController","loadingController","achievementController","deathController","inventoryController","jobController","logController","tutorialController","upgradeController"]);